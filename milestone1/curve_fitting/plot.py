from pprint import pprint
import matplotlib.pyplot as plt


grad_40 = [1.0914983062568686, 0.04412355810095931, 0.0017836842881696203, 7.210501099573953e-05]
grad_25 = [3.635654929414297, 0.48954171719724515, 0.06591689737591516, 0.008875724390787725, 0.0011951181957428438, 0.00016092292175344866, 2.1668306219154996e-05]
grad_15 = [8.10813159105917, 2.4348150141838216, 0.7311578613046097, 0.21956157450696367, 0.06593279994819858, 0.01979915711011777, 0.005945547930370806, 0.0017854063178855744, 0.0005361449870399859, 0.00016100057698527787, 4.834734340435641e-05, 1.451836786569768e-05]
grad_10 = [12.108194197890375, 5.429791456003432, 2.4349324741442024, 1.0919196808352707, 0.48965981687622967, 0.21958275912698721, 0.098469562835386, 0.04415763260980989, 0.019802022691947436, 0.008880007362555927, 0.003982145257715219, 0.0017857508678648928, 0.0008008010646322111, 0.0003591107565320396, 0.00016103941550366758, 7.221642044474674e-05, 3.238468898273192e-05, 1.452257057323104e-05]
grad_05 = [18.08135543282848, 12.108388891545108, 8.108522731802708, 5.42996607402236, 3.636239613584878, 2.435049933490511, 1.6306593648120185, 1.0919899125996442, 0.7312636807854147, 0.4896991855560869, 0.3279327260954192, 0.2196039446587674, 0.14706032265807756, 0.09848064675677129, 0.06594870465624197, 0.04416331318951902, 0.02957447370711239, 0.019804888534819487, 0.013262572777045654]

scale = 19

grad_40 += [0] * (scale - len(grad_40))
grad_25 += [0] * (scale - len(grad_25))
grad_15 += [0] * (scale - len(grad_15))
grad_10 += [0] * (scale - len(grad_10))

x = [i for i in range(19)]
x_label = [10000*(i + 1) for i in x]

f = plt.figure()
f.set_figwidth(10)
f.set_figheight(6)

plt.xticks(x, x_label, rotation=50)

l_05, = plt.plot(x, grad_05, c='b')
l_10, = plt.plot(x, grad_10, c='g')
l_15, = plt.plot(x, grad_15, c='r')
l_25, = plt.plot(x, grad_25, c='c')

plt.legend(
    handles=[l_05, l_10, l_15, l_25], 
    labels=['alpha=5e-5', 'alpha=1e-4', 'alpha=1.5e-4', 'alpha=2.5e-4']
)

plt.xlabel("Training epoch")
plt.ylabel("Gradient norm")
plt.savefig("./alpha_grad.png")